---
name: refactor-scan
description: "æ‰«æä»£ç è´¨é‡é—®é¢˜ï¼šå¤§æ–‡ä»¶ã€é•¿å‡½æ•°ã€é«˜å¤æ‚åº¦ã€é‡å¤æ¨¡å¼"
user-invocable: true
allowed-tools: Bash, Read, Grep, Glob
---

# ä»£ç è´¨é‡æ‰«æ

æ‰«æèŒƒå›´ï¼š$ARGUMENTSï¼ˆé»˜è®¤ä¸º `src/`ï¼‰

## æ‰§è¡Œæ­¥éª¤

### 1. æ‰«æå¤§æ–‡ä»¶

ç»Ÿè®¡ `src/` ä¸‹æ‰€æœ‰ `.rs` æ–‡ä»¶çš„è¡Œæ•°ï¼Œè¯†åˆ«è¶…è¿‡é˜ˆå€¼çš„æ–‡ä»¶ã€‚

**é˜ˆå€¼**ï¼š
| è¡Œæ•° | ä¸¥é‡ç¨‹åº¦ |
|------|----------|
| >300 | ğŸŸ¡ å…³æ³¨ |
| >500 | ğŸ”´ å»ºè®®æ‹†åˆ† |

### 2. æ‰«æé•¿å‡½æ•°

æœç´¢å‡½æ•°å®šä¹‰å¹¶åˆ†æå‡½æ•°ä½“é•¿åº¦ï¼š
- `pub fn`ã€`pub async fn`ã€`fn`ã€`async fn`
- ç»Ÿè®¡ä»å‡½æ•°ç­¾ååˆ°å¯¹åº”é—­åˆ `}` çš„è¡Œæ•°

**é˜ˆå€¼**ï¼š
| è¡Œæ•° | ä¸¥é‡ç¨‹åº¦ |
|------|----------|
| >50 | ğŸŸ¡ å…³æ³¨ |
| >80 | ğŸ”´ å»ºè®®æ‹†åˆ† |

### 3. æ‰«æåµŒå¥—æ·±åº¦

æ£€æŸ¥ä»¥ä¸‹æ·±åµŒå¥—æ¨¡å¼ï¼š
- å¤šå±‚ `if`/`match`/`for`/`while` åµŒå¥—ï¼ˆ>4 å±‚ï¼‰
- å¤šå±‚ `.map().and_then().unwrap_or()` é“¾å¼è°ƒç”¨

### 4. æ‰«æé‡å¤æ¨¡å¼

æœç´¢é¡¹ç›®ä¸­çš„é‡å¤ä»£ç ï¼š
- ç›¸ä¼¼çš„é”™è¯¯å¤„ç†æ¨¡å¼
- é‡å¤çš„é…ç½®è§£æé€»è¾‘
- ç›¸ä¼¼çš„åˆå§‹åŒ–/å…³é—­æµç¨‹
- é‡å¤çš„æµ‹è¯• setup ä»£ç 

### 5. æ£€æŸ¥æ¶æ„åˆè§„

æ ¹æ®é¡¹ç›®æ¶æ„è§„èŒƒæ£€æŸ¥ï¼š
- `mod.rs` æ˜¯å¦åªåŒ…å«æ¨¡å—å£°æ˜å’Œ `register_hook()`ï¼Œæ²¡æœ‰ä¸šåŠ¡é€»è¾‘
- `config.rs` æ˜¯å¦åªåŒ…å«é…ç½®ç»“æ„ä½“
- `client.rs` æ˜¯å¦åŒ…å«å…¨å±€çŠ¶æ€å’Œå¯¹å¤– API
- `init.rs` æ˜¯å¦åŒ…å«åˆå§‹åŒ–/å…³é—­é€»è¾‘
- å…¬å¼€ API æ˜¯å¦éƒ½æœ‰ `///` æ–‡æ¡£æ³¨é‡Š

### 6. ç”ŸæˆæŠ¥å‘Š

```
## ä»£ç è´¨é‡æŠ¥å‘Š

### å¤§æ–‡ä»¶ (>300 è¡Œ)
| æ–‡ä»¶ | è¡Œæ•° | å»ºè®® |
|------|------|------|
| src/xlog/init.rs | 450 | è€ƒè™‘æ‹†åˆ† |

### é•¿å‡½æ•° (>50 è¡Œ)
| å‡½æ•° | è¡Œæ•° | æ–‡ä»¶ |
|------|------|------|
| init_log | 65 | src/xlog/init.rs |

### æ·±åµŒå¥— (>4 å±‚)
| ä½ç½® | åµŒå¥—å±‚æ•° | å»ºè®® |
|------|----------|------|
| - | - | æ—  |

### é‡å¤ä»£ç æ¨¡å¼
| æ¨¡å¼ | å‡ºç°æ¬¡æ•° | ä½ç½® |
|------|----------|------|
| é…ç½®è§£æ | 3 | xorm, xcache, xhttp |

### æ¶æ„åˆè§„
| æ£€æŸ¥é¡¹ | çŠ¶æ€ |
|--------|------|
| mod.rs èŒè´£ | âœ…/âŒ |
| æ–‡æ¡£æ³¨é‡Š | âœ…/âŒ |

### é‡æ„ä¼˜å…ˆçº§
1. [é«˜] xxx - åŸå› 
2. [ä¸­] xxx - åŸå› 
3. [ä½] xxx - åŸå› 
```

## åˆ¤æ–­æ ‡å‡†

| æŒ‡æ ‡ | ğŸŸ¡ å…³æ³¨ | ğŸ”´ éœ€å¤„ç† |
|------|---------|-----------|
| æ–‡ä»¶è¡Œæ•° | >300 | >500 |
| å‡½æ•°è¡Œæ•° | >50 | >80 |
| åµŒå¥—å±‚çº§ | >3 | >4 |

## ç”¨æ³•

```
/refactor-scan                 # æ‰«ææ•´ä¸ª src/
/refactor-scan src/xorm/       # åªæ‰«æç‰¹å®šæ¨¡å—
```